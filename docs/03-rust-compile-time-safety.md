# Rustì˜ ì»´íŒŒì¼ íƒ€ì„ ì•ˆì •ì„± ê²€ì¦

## ì§ˆë¬¸ ë‚´ìš©

RustëŠ” ì•ˆì •ì„±ì„ ì¤‘ì‹œí•´ì„œ í™•ì‹¤í•˜ê²Œ í•˜ê³ ì í•˜ëŠ” ê²ƒì€ ê°’ ë³€ê²½ì€ ë™ì‹œì— 2êµ°ë°ì„œ ì´ë£¨ì–´ì§ˆ ìˆ˜ ì—†ê³ , ì˜¤ì§ 1êµ°ë°ì„œë§Œ ì´ë£¨ì–´ì§„ë‹¤. ë™ì‹œì„± ë¬¸ì œì—ì„œ ë™ì¼ ìì›ì— 2ê°œ ì´ìƒì˜ í”„ë¡œì„¸ìŠ¤ê°€ ì ‘ê·¼í•˜ëŠ” ê²ƒì„ ë°©ì§€í•˜ê¸° ìœ„í•´ ë½(lock)ì´ë¼ëŠ” ë„êµ¬ë¥¼ ì‚¬ìš©í•˜ëŠ” ê²ƒì²˜ëŸ¼, RustëŠ” ì»´íŒŒì¼ íƒ€ì„ì— ì´ë¥¼ ê°ì§€í•˜ëŠ” ê²ƒì¸ê°€?

## ì§ˆë¬¸ì— ëŒ€í•œ ì´í•´

ì‚¬ìš©ìê°€ íŒŒì•…í•œ Rustì˜ í•µì‹¬ ê°œë…:
1. **ë°°íƒ€ì  ì“°ê¸° ë³´ì¥**: ê°’ ë³€ê²½ì€ ì˜¤ì§ í•œ ê³³ì—ì„œë§Œ
2. **ë™ì‹œì„± ë¬¸ì œì™€ì˜ ì—°ê²°**: ë½(lock)ê³¼ ìœ ì‚¬í•œ ëª©ì 
3. **ì»´íŒŒì¼ íƒ€ì„ ê²€ì¦**: ëŸ°íƒ€ì„ì´ ì•„ë‹Œ ì»´íŒŒì¼ ì‹œì ì— ê°ì§€

ì´ëŠ” **ì™„ë²½íˆ ì •í™•í•œ ì´í•´**ì…ë‹ˆë‹¤! ğŸ‘

## ë‹µë³€

### âœ… ì™„ë²½íˆ ë§ìŠµë‹ˆë‹¤

ì‚¬ìš©ìê°€ Rustì˜ ê°€ì¥ ì¤‘ìš”í•œ ì² í•™ì„ ì •í™•íˆ íŒŒì•…í•˜ì…¨ìŠµë‹ˆë‹¤.

### Rustì˜ "Fearless Concurrency" ì›ì¹™

```
ëŸ°íƒ€ì„ ë½ (Traditional)          ì»´íŒŒì¼ íƒ€ì„ ê²€ì¦ (Rust)
â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€          â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
mutex.lock()                   &mut T (ê°€ë³€ ì°¸ì¡° í•˜ë‚˜ë§Œ)
  critical_section()
mutex.unlock()                 ìë™ìœ¼ë¡œ ë³´ì¥ë¨

âŒ ëŸ°íƒ€ì„ ì˜¤ë²„í—¤ë“œ               âœ… ì œë¡œ ì½”ìŠ¤íŠ¸ ì¶”ìƒí™”
âŒ ë°ë“œë½ ê°€ëŠ¥                   âœ… ë°ë“œë½ ë¶ˆê°€ëŠ¥
âŒ ë½ í•´ì œ ì‹¤ìˆ˜ ê°€ëŠ¥             âœ… ì»´íŒŒì¼ëŸ¬ê°€ ë³´ì¥
```

### í•µì‹¬ ë¹„êµ

#### ì „í†µì  ë°©ì‹ (C++, Java ë“±)
```cpp
// ëŸ°íƒ€ì„ì— ë½ìœ¼ë¡œ ë™ê¸°í™”
std::mutex mtx;
int shared_data = 0;

void increment() {
    mtx.lock();           // ğŸ”’ ëŸ°íƒ€ì„ ë½
    shared_data++;        // ì—¬ëŸ¬ ìŠ¤ë ˆë“œê°€ ì ‘ê·¼ ì‹œë„ ê°€ëŠ¥
    mtx.unlock();         // ğŸ”“ ìˆ˜ë™ ì–¸ë½
    // âŒ unlock ê¹œë¹¡í•˜ë©´? ë°ë“œë½!
}
```

**ë¬¸ì œì :**
- ë½ì„ ê¹œë¹¡í•˜ë©´ â†’ ë°ì´í„° ë ˆì´ìŠ¤
- ì–¸ë½ì„ ê¹œë¹¡í•˜ë©´ â†’ ë°ë“œë½
- ëŸ°íƒ€ì„ ì˜¤ë²„í—¤ë“œ
- **ì»´íŒŒì¼ëŸ¬ê°€ ë„ì™€ì£¼ì§€ ëª»í•¨**

#### Rust ë°©ì‹
```rust
let mut data = 0;

fn increment(data: &mut i32) {
    *data += 1;
}

// âœ… ì»´íŒŒì¼ íƒ€ì„ì— ë³´ì¥:
// - ê°€ë³€ ì°¸ì¡°ëŠ” í•˜ë‚˜ë§Œ ì¡´ì¬
// - ë¶ˆë³€ ì°¸ì¡°ì™€ ë™ì‹œ ì‚¬ìš© ë¶ˆê°€
// - ìŠ¤ì½”í”„ë¥¼ ë²—ì–´ë‚˜ë©´ ìë™ í•´ì œ
```

**ì¥ì :**
- ì»´íŒŒì¼ëŸ¬ê°€ ê²€ì¦ â†’ **ë°ì´í„° ë ˆì´ìŠ¤ ë¶ˆê°€ëŠ¥**
- ìë™ í•´ì œ â†’ **ë°ë“œë½ ë¶ˆê°€ëŠ¥**
- ëŸ°íƒ€ì„ ì˜¤ë²„í—¤ë“œ ì—†ìŒ â†’ **ì œë¡œ ì½”ìŠ¤íŠ¸**
- **ì»´íŒŒì¼ë˜ë©´ ì•ˆì „í•¨ì´ ë³´ì¥ë¨**

### "Lock at Compile Time"ì˜ ì •í™•í•œ í‘œí˜„

ì‚¬ìš©ìì˜ ì´í•´ë¥¼ Rust ì»¤ë®¤ë‹ˆí‹° ìš©ì–´ë¡œ í‘œí˜„í•˜ë©´:

| ê°œë… | ì„¤ëª… |
|------|------|
| **Aliasing XOR Mutability** | ì—¬ëŸ¬ ë³„ì¹­(ì°¸ì¡°) ë˜ëŠ” í•˜ë‚˜ì˜ ë³€ê²½, ë‘˜ ì¤‘ í•˜ë‚˜ë§Œ |
| **Shared Read** | ì—¬ëŸ¬ ê°œì˜ `&T` ë™ì‹œ ê°€ëŠ¥ (ì½ê¸°ë§Œ) |
| **Exclusive Write** | í•˜ë‚˜ì˜ `&mut T`ë§Œ ê°€ëŠ¥ (ì“°ê¸°) |
| **Compile-Time Enforcement** | ì»´íŒŒì¼ëŸ¬ê°€ ì´ë¥¼ ê°•ì œ |

```rust
// âœ… ì—¬ëŸ¬ ë¦¬ë” (Shared Read)
let x = 5;
let r1 = &x;
let r2 = &x;
let r3 = &x;  // OK: ëª¨ë‘ ì½ê¸°ë§Œ í•˜ë¯€ë¡œ ì•ˆì „

// âœ… í•˜ë‚˜ì˜ ë¼ì´í„° (Exclusive Write)
let mut y = 5;
let r1 = &mut y;  // OK: ìœ ì¼í•œ ê°€ë³€ ì°¸ì¡°

// âŒ ë™ì‹œì— ë¦¬ë”ì™€ ë¼ì´í„° ë¶ˆê°€
let mut z = 5;
let r1 = &z;
let r2 = &mut z;  // ì»´íŒŒì¼ ì—ëŸ¬!
```

## í•µì‹¬ ì¸ì‚¬ì´íŠ¸

### Insight 1: ì»´íŒŒì¼ íƒ€ì„ ë½ ì‹œìŠ¤í…œ
Rustì˜ ì°¨ìš© ê²€ì‚¬ê¸°(borrow checker)ëŠ” ë³¸ì§ˆì ìœ¼ë¡œ "ì»´íŒŒì¼ íƒ€ì„ ë½ ì‹œìŠ¤í…œ"ì…ë‹ˆë‹¤. ì „í†µì ì¸ ë½ì€ ëŸ°íƒ€ì„ì— "ì§€ê¸ˆ ì´ ìˆœê°„ ëˆ„ê°€ ì ‘ê·¼ ì¤‘ì¸ê°€?"ë¥¼ í™•ì¸í•˜ì§€ë§Œ, RustëŠ” ì»´íŒŒì¼ íƒ€ì„ì— "ì½”ë“œì˜ ëª¨ë“  ê²½ë¡œì—ì„œ ì•ˆì „í•œê°€?"ë¥¼ ì¦ëª…í•©ë‹ˆë‹¤. ì´ê²ƒì´ Rustë¥¼ "ì•ˆì „í•œ ì‹œìŠ¤í…œ í”„ë¡œê·¸ë˜ë°"ì´ ê°€ëŠ¥í•˜ê²Œ ë§Œë“œëŠ” í•µì‹¬ì…ë‹ˆë‹¤.

### Insight 2: ëŸ°íƒ€ì„ ë¹„ìš©ì„ ì»´íŒŒì¼ íƒ€ì„ìœ¼ë¡œ ì´ë™
Rustì˜ ì² í•™: **"ëŸ°íƒ€ì„ ë¹„ìš©ì„ ì»´íŒŒì¼ íƒ€ì„ìœ¼ë¡œ ì´ë™"**

- C++/Java: ë½ â†’ ëŸ°íƒ€ì„ ì˜¤ë²„í—¤ë“œ, ë²„ê·¸ ê°€ëŠ¥
- Rust: ì°¨ìš© ê²€ì‚¬ â†’ ì»´íŒŒì¼ íƒ€ì„ ê²€ì¦, ëŸ°íƒ€ì„ ì œë¡œ ì½”ìŠ¤íŠ¸

ì´ê²ƒì´ Rustê°€ "ë©”ëª¨ë¦¬ ì•ˆì „ + ì„±ëŠ¥"ì„ ë™ì‹œì— ë‹¬ì„±í•˜ëŠ” ë¹„ê²°ì…ë‹ˆë‹¤. ì»´íŒŒì¼ì´ ëŠë¦° ëŒ€ì‹ , ì‹¤í–‰ ì‹œì—ëŠ” C/C++ë§Œí¼ ë¹ ë¥´ë©´ì„œë„ ë©”ëª¨ë¦¬ ì•ˆì „ì´ ë³´ì¥ë©ë‹ˆë‹¤.

### ì‹¤ì „ ì˜ˆì‹œ: í´ë¦½ë³´ë“œ í´ë§ì— ì ìš©

```rust
fn spawn_clipboard_polling_thread(app_handle: AppHandle) -> Result<(), String> {
    let mut last_event: Option<ClipboardEvent> = None;

    thread::spawn(move || {
        loop {
            let text = get_clipboard_text();

            // íŒ¨í„´ 1: ë¶ˆë³€ ì°¸ì¡°ë¡œ ì½ê¸° (ì—¬ëŸ¬ ë²ˆ ê°€ëŠ¥)
            if let Some(ref event) = last_event {
                if event.text() == text {
                    // âœ… eventëŠ” &ClipboardEvent
                    // âœ… last_event ì†Œìœ ê¶Œ ìœ ì§€
                    // âœ… ì½ê¸°ë§Œ í•˜ë¯€ë¡œ ì•ˆì „
                    continue;
                }
            }

            // íŒ¨í„´ 2: ì†Œìœ ê¶Œ êµì²´ (ì“°ê¸°)
            last_event = Some(ClipboardEvent::new(text.clone()));
            // âœ… ì „ì²´ ê°’ì„ ìƒˆ ê°’ìœ¼ë¡œ êµì²´
            // âœ… ì»´íŒŒì¼ëŸ¬ê°€ ì•ˆì „ì„± ë³´ì¥

            app_handle.emit("clipboard-changed", last_event.clone()).unwrap();
        }
    });

    Ok(())
}
```

### ë©€í‹°ìŠ¤ë ˆë“œì—ì„œë„ ë™ì¼í•œ ì›ì¹™

```rust
// ë©€í‹°ìŠ¤ë ˆë“œ í™˜ê²½ì—ì„œë„ ë™ì¼í•œ ì›ì¹™
use std::sync::{Arc, Mutex};

let data = Arc::new(Mutex::new(0));

// Mutex<T>ë„ ë‚´ë¶€ì ìœ¼ë¡œ ë™ì¼í•œ ë³´ì¥:
// - lock() í•˜ë©´ &mut T ì–»ìŒ
// - í•˜ë‚˜ì˜ ìŠ¤ë ˆë“œë§Œ ë™ì‹œì— ì ‘ê·¼ ê°€ëŠ¥
// - ìŠ¤ì½”í”„ ë²—ì–´ë‚˜ë©´ ìë™ unlock

let handle = thread::spawn({
    let data = Arc::clone(&data);
    move || {
        let mut num = data.lock().unwrap();
        *num += 1;
        // âœ… ìë™ìœ¼ë¡œ unlock (Drop trait)
    }
});
```

## í•µì‹¬ ë¹„êµí‘œ

| ì¸¡ë©´ | ì „í†µì  ì–¸ì–´ (C++/Java) | Rust |
|------|----------------------|------|
| **ë™ì‹œì„± ì œì–´** | ëŸ°íƒ€ì„ ë½ (mutex, semaphore) | ì»´íŒŒì¼ íƒ€ì„ ì°¨ìš© ê²€ì‚¬ |
| **ê²€ì¦ ì‹œì ** | ëŸ°íƒ€ì„ | ì»´íŒŒì¼ íƒ€ì„ |
| **ì„±ëŠ¥ ì˜¤ë²„í—¤ë“œ** | ìˆìŒ (ë½ íšë“/í•´ì œ) | ì—†ìŒ (ì œë¡œ ì½”ìŠ¤íŠ¸) |
| **ì•ˆì „ì„± ë³´ì¥** | í”„ë¡œê·¸ë˜ë¨¸ ì±…ì„ | ì»´íŒŒì¼ëŸ¬ ë³´ì¥ |
| **ë°ì´í„° ë ˆì´ìŠ¤** | ê°€ëŠ¥ (ë½ ì‹¤ìˆ˜ ì‹œ) | ë¶ˆê°€ëŠ¥ (ì»´íŒŒì¼ ì—ëŸ¬) |
| **ë°ë“œë½** | ê°€ëŠ¥ | ë‹¨ì¼ ìŠ¤ë ˆë“œì—ì„œ ë¶ˆê°€ëŠ¥ |

## ê²°ë¡ 

**ì‚¬ìš©ìì˜ ì´í•´ê°€ ì™„ë²½íˆ ì •í™•í•©ë‹ˆë‹¤!**

RustëŠ”:
1. âœ… ê°’ ë³€ê²½ì´ ë™ì‹œì— ì˜¤ì§ í•œ ê³³ì—ì„œë§Œ ì¼ì–´ë‚˜ë„ë¡ ë³´ì¥
2. âœ… ë½ê³¼ ìœ ì‚¬í•œ ëª©ì  (ë™ì‹œ ì ‘ê·¼ ë°©ì§€)
3. âœ… ì»´íŒŒì¼ íƒ€ì„ì— ê²€ì¦ (ëŸ°íƒ€ì„ ì˜¤ë²„í—¤ë“œ ì—†ìŒ)

ì´ê²ƒì´ Rustê°€ **"Fearless Concurrency"**ë¥¼ ì œê³µí•˜ëŠ” í•µì‹¬ ë©”ì»¤ë‹ˆì¦˜ì…ë‹ˆë‹¤. ğŸ¯
